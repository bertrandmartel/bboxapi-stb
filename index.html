
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Bbox API STB client</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;kotlin&quot;,&quot;java&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="kotlin">kotlin</a>
              <a href="#" data-language-name="java">java</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="overview">Overview</a>
          </li>
          <li>
            <a href="#security" class="toc-h1 toc-link" data-title="security">Security</a>
          </li>
          <li>
            <a href="#usage" class="toc-h1 toc-link" data-title="usage">Usage</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#gradle" class="toc-h2 toc-link" data-title="gradle">Gradle</a>
                  </li>
                  <li>
                    <a href="#synchronous-amp-asynchronous" class="toc-h2 toc-link" data-title="synchronous-amp-asynchronous">Synchronous &amp; Asynchronous</a>
                  </li>
                  <li>
                    <a href="#format" class="toc-h2 toc-link" data-title="format">Format</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#service-discovery" class="toc-h1 toc-link" data-title="service-discovery">Service discovery</a>
          </li>
          <li>
            <a href="#api-reference" class="toc-h1 toc-link" data-title="api-reference">API reference</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#display-toast" class="toc-h2 toc-link" data-title="display-toast">Display Toast</a>
                  </li>
                  <li>
                    <a href="#get-tv-channel-list" class="toc-h2 toc-link" data-title="get-tv-channel-list">Get TV channel list</a>
                  </li>
                  <li>
                    <a href="#get-application-list" class="toc-h2 toc-link" data-title="get-application-list">Get Application list</a>
                  </li>
                  <li>
                    <a href="#get-application-info" class="toc-h2 toc-link" data-title="get-application-info">Get Application info</a>
                  </li>
                  <li>
                    <a href="#get-application-icon" class="toc-h2 toc-link" data-title="get-application-icon">Get Application icon</a>
                  </li>
                  <li>
                    <a href="#get-current-tv-channel" class="toc-h2 toc-link" data-title="get-current-tv-channel">Get current TV channel</a>
                  </li>
                  <li>
                    <a href="#get-volume" class="toc-h2 toc-link" data-title="get-volume">Get volume</a>
                  </li>
                  <li>
                    <a href="#set-volume" class="toc-h2 toc-link" data-title="set-volume">Set volume</a>
                  </li>
                  <li>
                    <a href="#start-application" class="toc-h2 toc-link" data-title="start-application">Start application</a>
                  </li>
                  <li>
                    <a href="#custom-http-request" class="toc-h2 toc-link" data-title="custom-http-request">Custom HTTP request</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#notifications" class="toc-h1 toc-link" data-title="notifications">Notifications</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#subscribe-notifications" class="toc-h2 toc-link" data-title="subscribe-notifications">Subscribe notifications</a>
                  </li>
                  <li>
                    <a href="#unsubscribe-all-channels" class="toc-h2 toc-link" data-title="unsubscribe-all-channels">Unsubscribe all channels</a>
                  </li>
                  <li>
                    <a href="#send-notification" class="toc-h2 toc-link" data-title="send-notification">Send notification</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="errors">Errors</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/bertrandmartel/bboxapi-stb'>Contribute to Documentation</a></li>
            <li><a href='https://github.com/lord/slate'>Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Bbox API STB client is a Kotlin HTTP client library for accessing <a href="https://api.bbox.fr/doc/#API%20Box">Bbox Miami API</a>. Those API are available if you have a <a href="https://www.bouyguestelecom.fr/offres-internet/bbox-miami">Bbox Miami</a> which is a Set-Top-Box (TV box) provided by French Internet Service Provider <a href="https://www.bouyguestelecom.fr/">Bouygues Telecom</a>.</p>

<p>This library is fully compatible with Kotlin, Java &amp; Android projects. </p>
<h1 id='overview'>Overview</h1>
<p>Bbox Miami Api are composed of </p>

<ul>
<li><p>REST API used to :</p>

<ul>
<li>get TV channel list</li>
<li>get list of Android applications installed</li>
<li>get information about a specific installed Android app</li>
<li>get Android application icon</li>
<li>get current TV channel</li>
<li>get volume value</li>
<li>start an Android app</li>
<li>display a Toast message</li>
<li>set volume </li>
</ul></li>
<li><p>Websocket event used to :</p>

<ul>
<li>get notified when a TV channel change is detected</li>
<li>get notified when an Android application state change </li>
<li>receive custom message from clients</li>
</ul></li>
</ul>

<p>Box IP/port is broadcasted on local network via MDNS (Multicast DNS) on local network</p>

<p><img src="images/overview.png" alt="architecture" /></p>
<h1 id='security'>Security</h1>
<p>These API are secured using : </p>

<ul>
<li>a token which is exchanged for an AppId/AppSecret</li>
<li>a sessionId which is exchanged for the previous token. This sessionId will be passed in a custom header for each subsequent API call</li>
</ul>

<p>For more information check API Security section of <a href="https://api.bbox.fr/doc/#Getting%20started">this page</a></p>

<p><strong>An AppId &amp; AppSecret are necessary to use this library, you can get them by contacting Bouygues Télécom via <a href="https://dev.bouyguestelecom.fr/dev/?page_id=51">this contact page</a></strong></p>
<h1 id='usage'>Usage</h1><h2 id='gradle'>Gradle</h2>
<p>Dependency is available on JCenter or Maven Central
with Gradle, from JCenter or MavenCentral :</p>
<pre class="highlight groovy tab-groovy"><code><span class="n">repositories</span> <span class="o">{</span>
    <span class="n">jcenter</span><span class="o">()</span> <span class="c1">//or mavenCentral()</span>
<span class="o">}</span>

<span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">compile</span> <span class="s1">'fr.bmartel:bboxapi-stb:1.0.3'</span> <span class="c1">//for JVM</span>
    <span class="n">compile</span> <span class="s1">'fr.bmartel:bboxapi-stb-android:1.0.3'</span> <span class="c1">//for Android</span>
<span class="o">}</span>
</code></pre><h2 id='synchronous-amp-asynchronous'>Synchronous &amp; Asynchronous</h2>
<p>All methods have an asynchronous &amp; synchronous version. The synchronous version is suffixed with <code>Sync</code> :</p>

<ul>
<li><code>getChannels</code> is asynchronous, result is returned in callback function</li>
<li><code>getChannelsSync</code> is synchronous, it directly returns the result</li>
</ul>
<h2 id='format'>Format</h2>
<p>The format is the same as the one used in <a href="https://github.com/kittinunf/Fuel">Fuel</a> HTTP client library</p>

<ul>
<li>Asynchronous method</li>
</ul>

<p>The callback function is given in parameter, a <code>Request</code> &amp; <code>Response</code> objects are returned along with a <a href="https://github.com/kittinunf/Result">Result object</a> holding the data and a <code>FuelError</code> object in case of failure.</p>

<p>For instance, for <code>getChannels</code> it will return <code>(Request, Response, Result&lt;List&lt;Channel&gt;, FuelError&gt;)</code></p>

<p>In case of Java, an <code>Handler</code> function is used that have 2 callbacks : <code>onSuccess</code> &amp; <code>onError</code></p>

<ul>
<li>Synchronous method :</li>
</ul>

<p>A <code>Triple&lt;Request, Response, T&gt;</code> object is returned.</p>
<h1 id='service-discovery'>Service discovery</h1>
<blockquote>
<p>Desktop platform</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="py">bboxapi</span> <span class="p">=</span> <span class="n">BboxApiStb</span><span class="p">(</span><span class="n">appId</span> <span class="p">=</span> <span class="s">"YourAppId"</span><span class="p">,</span> <span class="n">appSecret</span> <span class="p">=</span> <span class="s">"YourAppSecret"</span><span class="p">)</span>

<span class="n">bboxapi</span><span class="p">.</span><span class="n">startRestDiscovery</span><span class="p">(</span><span class="n">findOneAndExit</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">maxDuration</span> <span class="p">=</span> <span class="m">10000</span><span class="p">,</span> <span class="n">platform</span> <span class="p">=</span> <span class="n">DesktopPlatform</span><span class="p">.</span><span class="n">create</span><span class="p">())</span> <span class="p">{</span> <span class="n">eventType</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">error</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">eventType</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">StbServiceEvent</span><span class="p">.</span><span class="n">SERVICE_FOUND</span> <span class="p">-&gt;</span> <span class="n">println</span><span class="p">(</span><span class="s">"service found : ${service?.ip}:${service?.port}"</span><span class="p">)</span>
        <span class="n">StbServiceEvent</span><span class="p">.</span><span class="n">DISCOVERY_STOPPED</span> <span class="p">-&gt;</span> <span class="n">println</span><span class="p">(</span><span class="s">"end of discovery"</span><span class="p">)</span>
        <span class="n">StbServiceEvent</span><span class="p">.</span><span class="n">DISCOVERY_ERROR</span> <span class="p">-&gt;</span> <span class="n">error</span><span class="o">?.</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">BboxApiStb</span> <span class="n">bboxapi</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BboxApiStb</span><span class="o">(</span><span class="s">"YourAppId"</span><span class="o">,</span> <span class="s">"YourAppSecret"</span><span class="o">);</span>

<span class="n">bboxapi</span><span class="o">.</span><span class="na">startRestDiscovery</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">DesktopPlatform</span><span class="o">.</span><span class="na">create</span><span class="o">(),</span> <span class="mi">10000</span><span class="o">,</span> <span class="o">(</span><span class="n">stbServiceEvent</span><span class="o">,</span> <span class="n">stbService</span><span class="o">,</span> <span class="n">throwable</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">switch</span> <span class="o">(</span><span class="n">stbServiceEvent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nl">SERVICE_FOUND:</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"service found : "</span> <span class="o">+</span> <span class="n">stbService</span><span class="o">.</span><span class="na">getIp</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">stbService</span><span class="o">.</span><span class="na">getPort</span><span class="o">());</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="nl">DISCOVERY_STOPPED:</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"end of discovery"</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="nl">DISCOVERY_ERROR:</span>
            <span class="n">throwable</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">Unit</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Android platform </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="py">bboxapi</span> <span class="p">=</span> <span class="n">BboxApiStb</span><span class="p">(</span><span class="n">appId</span> <span class="p">=</span> <span class="s">"YourAppId"</span><span class="p">,</span> <span class="n">appSecret</span> <span class="p">=</span> <span class="s">"YourAppSecret"</span><span class="p">)</span>

<span class="n">bboxapi</span><span class="p">.</span><span class="n">startRestDiscovery</span><span class="p">(</span><span class="n">findOneAndExit</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">maxDuration</span> <span class="p">=</span> <span class="m">10000</span><span class="p">,</span> <span class="n">platform</span> <span class="p">=</span> <span class="n">AndroidPlatform</span><span class="p">.</span><span class="n">create</span><span class="p">())</span> <span class="p">{</span> <span class="n">eventType</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">error</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">eventType</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">StbServiceEvent</span><span class="p">.</span><span class="n">SERVICE_FOUND</span> <span class="p">-&gt;</span> <span class="n">println</span><span class="p">(</span><span class="s">"service found : ${service?.ip}:${service?.port}"</span><span class="p">)</span>
        <span class="n">StbServiceEvent</span><span class="p">.</span><span class="n">DISCOVERY_STOPPED</span> <span class="p">-&gt;</span> <span class="n">println</span><span class="p">(</span><span class="s">"end of discovery"</span><span class="p">)</span>
        <span class="n">StbServiceEvent</span><span class="p">.</span><span class="n">DISCOVERY_ERROR</span> <span class="p">-&gt;</span> <span class="n">error</span><span class="o">?.</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">BboxApiStb</span> <span class="n">bboxapi</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BboxApiStb</span><span class="o">(</span><span class="s">"YourAppId"</span><span class="o">,</span> <span class="s">"YourAppSecret"</span><span class="o">);</span>

<span class="n">bboxapi</span><span class="o">.</span><span class="na">startRestDiscovery</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">AndroidPlatform</span><span class="o">.</span><span class="na">create</span><span class="o">(),</span> <span class="mi">10000</span><span class="o">,</span> <span class="o">(</span><span class="n">stbServiceEvent</span><span class="o">,</span> <span class="n">stbService</span><span class="o">,</span> <span class="n">throwable</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">switch</span> <span class="o">(</span><span class="n">stbServiceEvent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nl">SERVICE_FOUND:</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"service found : "</span> <span class="o">+</span> <span class="n">stbService</span><span class="o">.</span><span class="na">getIp</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">stbService</span><span class="o">.</span><span class="na">getPort</span><span class="o">());</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="nl">DISCOVERY_STOPPED:</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"end of discovery"</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="nl">DISCOVERY_ERROR:</span>
            <span class="n">throwable</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">Unit</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
<span class="o">});</span>
</code></pre>
<p>In order to find Bbox Miami IP adress, use the mDNS broadcast feature exposed by BboxAPI Miami service</p>

<p>You have to add the following dependency depending on platform : </p>

<ul>
<li>Desktop : <code>implementation &quot;de.mannodermaus.rxjava2:rxbonjour-platform-desktop:2.0.0-RC1&quot;</code></li>
<li>Android : <code>implementation &quot;de.mannodermaus.rxjava2:rxbonjour-platform-android:2.0.0-RC1&quot;</code></li>
</ul>

<p>Also using <code>startRestDiscovery</code> :</p>

<ul>
<li>setting <code>findOneAndExit</code> to <code>true</code> will automatically end the discovery when one service is found</li>
<li>setting <code>maxDuration</code> parameter will set a max duration in milliseconds for service discovery</li>
</ul>

<p>The last service found is automatically chosen and set in variable <code>bboxapi.restService</code>.</p>

<p>The list of services found is available in <code>bboxapi.restServiceList</code>. In special environments where there are multiple Bbox Miami or multiple Android TV device with Bbox API STB service installed on the same network, there can be more than one service found if <code>findOneAndExit</code> is set to <code>false</code>.</p>
<h1 id='api-reference'>API reference</h1><h2 id='display-toast'>Display Toast</h2>
<blockquote>
<p>Asynchronous </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="py">toast</span> <span class="p">=</span> <span class="n">ToastRequest</span><span class="p">(</span><span class="n">message</span> <span class="p">=</span> <span class="s">"this is a message"</span><span class="p">,</span> <span class="n">pos_y</span> <span class="p">=</span> <span class="m">500</span><span class="p">,</span> <span class="n">pos_x</span> <span class="p">=</span> <span class="m">300</span><span class="p">,</span> <span class="n">color</span> <span class="p">=</span> <span class="s">"#FF0000"</span><span class="p">)</span>

<span class="n">bboxapi</span><span class="p">.</span><span class="n">displayToast</span><span class="p">(</span><span class="n">toast</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">ToastRequest</span> <span class="n">toastRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ToastRequest</span><span class="o">(</span><span class="s">"this is a toast"</span><span class="o">,</span> <span class="s">"#FF0000"</span><span class="o">,</span> <span class="mi">500</span><span class="o">,</span> <span class="mi">300</span><span class="o">);</span>

<span class="n">bboxapi</span><span class="o">.</span><span class="na">displayToast</span><span class="o">(</span><span class="n">toastRequest</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="py">toast</span> <span class="p">=</span> <span class="n">ToastRequest</span><span class="p">(</span><span class="n">message</span> <span class="p">=</span> <span class="s">"this is a message"</span><span class="p">,</span> <span class="n">pos_y</span> <span class="p">=</span> <span class="m">500</span><span class="p">,</span> <span class="n">pos_x</span> <span class="p">=</span> <span class="m">200</span><span class="p">,</span> <span class="n">color</span> <span class="p">=</span> <span class="s">"#FF0000"</span><span class="p">)</span>

<span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">displayToastSync</span><span class="p">(</span><span class="n">toast</span><span class="p">)</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">statusCode</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">ToastRequest</span> <span class="n">toastRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ToastRequest</span><span class="o">(</span><span class="s">"this is a toast"</span><span class="o">,</span> <span class="s">"#FF0000"</span><span class="o">,</span> <span class="mi">500</span><span class="o">,</span> <span class="mi">300</span><span class="o">);</span>

<span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">displayToastSync</span><span class="o">(</span><span class="n">toastRequest</span><span class="o">);</span>
<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
</code></pre>
<p>Display a Toast message</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>default value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>string</td>
<td><code>&quot;&quot;</code></td>
<td>toast message</td>
</tr>
<tr>
<td>color</td>
<td>string</td>
<td><code>null</code></td>
<td>toast text color in hex string format (ex: #FF0000)</td>
</tr>
<tr>
<td>pos_x</td>
<td>int</td>
<td><code>null</code></td>
<td>toast X position</td>
</tr>
<tr>
<td>pos_y</td>
<td>int</td>
<td><code>null</code></td>
<td>toast Y position</td>
</tr>
</tbody></table>
<h2 id='get-tv-channel-list'>Get TV channel list</h2>
<blockquote>
<p>Asynchronous </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getChannels</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getChannels</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span> <span class="n">channels</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">channels</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">getChannelsSync</span><span class="p">()</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;,</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">getChannelsSync</span><span class="o">();</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;,</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</code></pre>
<p>Get list of TV channel with the following information :</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mediaState</td>
<td>string</td>
<td>state of media <code>play</code> or <code>stop</code></td>
</tr>
<tr>
<td>mediaTitle</td>
<td>string</td>
<td>channel name</td>
</tr>
<tr>
<td>positionId</td>
<td>int</td>
<td>channel position</td>
</tr>
</tbody></table>
<h2 id='get-application-list'>Get Application list</h2>
<blockquote>
<p>Asynchronous </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getApps</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getApps</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;</span> <span class="n">channels</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">channels</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">getAppsSync</span><span class="p">()</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;,</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">getAppsSync</span><span class="o">();</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;,</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</code></pre>
<p>Get list of Android application installed on Bbox. The information includes the following :</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>appId</td>
<td>string</td>
<td>application id</td>
</tr>
<tr>
<td>appName</td>
<td>string</td>
<td>application name (ex: Youtube)</td>
</tr>
<tr>
<td>packageName</td>
<td>string</td>
<td>application package name (ex: com.google.youtube)</td>
</tr>
<tr>
<td>component</td>
<td>string</td>
<td>component intent</td>
</tr>
<tr>
<td>appState</td>
<td>string</td>
<td>application state (stopped/foreground)</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>data intent</td>
</tr>
<tr>
<td>leanback</td>
<td>boolean</td>
<td>if app is an Android TV app</td>
</tr>
<tr>
<td>logoUrl </td>
<td>string</td>
<td>path to getAppIcon for this package name</td>
</tr>
</tbody></table>
<h2 id='get-application-info'>Get Application info</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getAppInfo</span><span class="p">(</span><span class="n">packageName</span> <span class="p">=</span> <span class="s">"com.google.android.youtube.tv"</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">ex</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">()</span>
            <span class="n">ex</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">data</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">()</span>
            <span class="n">println</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getAppInfo</span><span class="o">(</span><span class="s">"com.google.android.youtube.tv"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;</span> <span class="n">channels</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">channels</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">getAppInfoSync</span><span class="p">(</span><span class="n">packageName</span> <span class="p">=</span> <span class="s">"com.google.android.youtube.tv"</span><span class="p">)</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;,</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">getAppInfoSync</span><span class="o">(</span><span class="s">"com.google.android.youtube.tv"</span><span class="o">);</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;,</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</code></pre>
<p>Get information about a specific application by package name :</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>appId</td>
<td>string</td>
<td>application id</td>
</tr>
<tr>
<td>appName</td>
<td>string</td>
<td>application name (ex: Youtube)</td>
</tr>
<tr>
<td>packageName</td>
<td>string</td>
<td>application package name (ex: com.google.youtube)</td>
</tr>
<tr>
<td>component</td>
<td>string</td>
<td>component intent</td>
</tr>
<tr>
<td>appState</td>
<td>string</td>
<td>application state (stopped/foreground)</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>data intent</td>
</tr>
<tr>
<td>leanback</td>
<td>boolean</td>
<td>if app is an Android TV app</td>
</tr>
<tr>
<td>logoUrl </td>
<td>string</td>
<td>path to getAppIcon for this package name</td>
</tr>
</tbody></table>
<h2 id='get-application-icon'>Get Application icon</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getAppIcon</span><span class="p">(</span><span class="n">packageName</span> <span class="p">=</span> <span class="s">"com.google.android.youtube.tv"</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">().</span><span class="n">size</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getAppIcon</span><span class="o">(</span><span class="s">"com.google.android.youtube.tv"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">image</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">getAppIconSync</span><span class="p">(</span><span class="n">packageName</span> <span class="p">=</span> <span class="s">"com.google.android.youtube.tv"</span><span class="p">)</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">().</span><span class="n">size</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">getAppIconSync</span><span class="o">(</span><span class="s">"com.google.android.youtube.tv"</span><span class="o">);</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">length</span><span class="o">);</span>
</code></pre>
<p>Retrieve Android application icon for a specific package name</p>
<h2 id='get-current-tv-channel'>Get current TV channel</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getCurrentChannel</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getCurrentChannel</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">Media</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">Media</span> <span class="n">channel</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">channel</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">getCurrentChannelSync</span><span class="p">()</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="n">Media</span><span class="o">,</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">getCurrentChannelSync</span><span class="o">();</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">Media</span><span class="o">,</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</code></pre>
<p>Get current TV channel with the following information :</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mediaService</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>mediaState</td>
<td>string</td>
<td>media state (stop/play)</td>
</tr>
<tr>
<td>mediaTitle</td>
<td>string</td>
<td>channel name</td>
</tr>
</tbody></table>
<h2 id='get-volume'>Get volume</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getVolume</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getVolume</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">Volume</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">Volume</span> <span class="n">volume</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">volume</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">getVolumeSync</span><span class="p">()</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="n">Volume</span><span class="o">,</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">getVolumeSync</span><span class="o">();</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="n">Volume</span><span class="o">,</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</code></pre>
<p>Get volume value</p>

<p>Get current TV channel with the following information :</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>volume</td>
<td>string</td>
<td>volume value (yes this is a string !?)</td>
</tr>
</tbody></table>
<h2 id='set-volume'>Set volume</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">setVolume</span><span class="p">(</span><span class="n">volume</span> <span class="p">=</span> <span class="m">10</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">setVolume</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">setVolumeSync</span><span class="p">(</span><span class="n">volume</span> <span class="p">=</span> <span class="m">100</span><span class="p">)</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">setVolumeSync</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
</code></pre>
<p>Set volume</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>volume</td>
<td>int</td>
<td>volume value</td>
</tr>
</tbody></table>
<h2 id='start-application'>Start application</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">startApp</span><span class="p">(</span><span class="n">packageName</span> <span class="p">=</span> <span class="s">"com.google.android.youtube.tv"</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">startApp</span><span class="o">(</span><span class="s">"com.google.android.youtube.tv"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">startAppSync</span><span class="p">(</span><span class="n">packageName</span> <span class="p">=</span> <span class="s">"com.google.android.youtube.tv"</span><span class="p">)</span>

<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">startAppSync</span><span class="o">(</span><span class="s">"com.google.android.youtube.tv"</span><span class="o">);</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
</code></pre>
<p>Start Android application by package name</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>packageName</td>
<td>string</td>
<td>application package name (ex: com.google.youtube)</td>
</tr>
</tbody></table>
<h2 id='custom-http-request'>Custom HTTP request</h2>
<blockquote>
<p>Asynchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">createCustomRequest</span><span class="p">(</span><span class="n">bboxapi</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/applications"</span><span class="p">))</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">()))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">createCustomRequest</span><span class="o">(</span><span class="n">bboxapi</span><span class="o">.</span><span class="na">getManager</span><span class="o">().</span><span class="na">request</span><span class="o">(</span><span class="n">Method</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="s">"/applications"</span><span class="o">,</span> <span class="kc">null</span><span class="o">),</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">data</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<blockquote>
<p>Synchronous</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">createCustomRequestSync</span><span class="p">(</span><span class="n">bboxapi</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/applications"</span><span class="p">))</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">()))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">createCustomRequestSync</span><span class="o">(</span><span class="n">bboxapi</span><span class="o">.</span><span class="na">getManager</span><span class="o">().</span><span class="na">request</span><span class="o">(</span><span class="n">Method</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="s">"/applications"</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>

<span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
<span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getThird</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">()));</span>
</code></pre>
<p>Create your own HTTP request, this can be useful for not relying on the library implementation</p>

<p><strong>All request construction are prefixed with <a href="http://$boxIp:$boxRestPort/api.bbox.lan/v0">http://$boxIp:$boxRestPort/api.bbox.lan/v0</a> if host is not specified</strong></p>
<h1 id='notifications'>Notifications</h1>
<p>BboxAPI Miami service dispatch notifications via WebSocket on port 9090. This library abstracts all the flow involving app registering, subscribing to events &amp; opening websocket. This flow is described <a href="https://api.bbox.fr/doc/#SDK%20Mobile">here</a></p>
<h2 id='subscribe-notifications'>Subscribe notifications</h2><pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="py">notificationChannel</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">subscribeNotification</span><span class="p">(</span>
        <span class="n">appName</span> <span class="p">=</span> <span class="s">"myApplication"</span><span class="p">,</span>
        <span class="n">resourceList</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Application</span><span class="p">,</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Media</span><span class="p">,</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Message</span><span class="p">),</span>
        <span class="n">listener</span> <span class="p">=</span> <span class="kd">object</span> <span class="err">: </span><span class="nc">BboxApiStb</span><span class="p">.</span><span class="n">WebSocketListener</span> <span class="p">{</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onOpen</span><span class="p">()</span> <span class="p">{</span>
                <span class="n">println</span><span class="p">(</span><span class="s">"websocket opened"</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onClose</span><span class="p">()</span> <span class="p">{</span>
                <span class="n">println</span><span class="p">(</span><span class="s">"websocket closed"</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onApp</span><span class="p">(</span><span class="n">app</span><span class="p">:</span> <span class="n">AppEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">println</span><span class="p">(</span><span class="s">"application event : $app"</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onMedia</span><span class="p">(</span><span class="n">media</span><span class="p">:</span> <span class="n">MediaEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">println</span><span class="p">(</span><span class="s">"channel change event : $media"</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onMessage</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">MessageEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">println</span><span class="p">(</span><span class="s">"message event : $message"</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onError</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">BboxApiError</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">println</span><span class="p">(</span><span class="s">"error : $error"</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">override</span> <span class="k">fun</span> <span class="nf">onFailure</span><span class="p">(</span><span class="n">throwable</span><span class="p">:</span> <span class="n">Throwable</span><span class="p">?)</span> <span class="p">{</span>
                <span class="n">throwable</span><span class="o">?.</span><span class="n">printStackTrace</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">})</span>
<span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">notificationChannel</span><span class="p">.</span><span class="n">subscribeResult</span>
<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result</span><span class="p">.</span><span class="n">error</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">()</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">println</span><span class="p">(</span><span class="s">"subscribed on channelId ${notificationChannel.channelId} &amp; appId ${notificationChannel.appId}"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Resource</span><span class="o">&gt;</span> <span class="n">resourceList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">resourceList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Resource</span><span class="o">.</span><span class="na">Application</span><span class="o">);</span>
<span class="n">resourceList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Resource</span><span class="o">.</span><span class="na">Media</span><span class="o">);</span>
<span class="n">resourceList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Resource</span><span class="o">.</span><span class="na">Message</span><span class="o">);</span>

<span class="n">NotificationChannel</span> <span class="n">notificationChannel</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">subscribeNotification</span><span class="o">(</span>
        <span class="s">"myApplication"</span><span class="o">,</span>
        <span class="n">resourceList</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">BboxApiStb</span><span class="o">.</span><span class="na">WebSocketListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onOpen</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"websocket opened"</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClose</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"websocket closed"</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="n">BboxApiError</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"error : "</span> <span class="o">+</span> <span class="n">error</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMedia</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="n">MediaEvent</span> <span class="n">media</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"channel change event : "</span> <span class="o">+</span> <span class="n">media</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onApp</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="n">AppEvent</span> <span class="n">app</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"application event : "</span> <span class="o">+</span> <span class="n">app</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMessage</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="n">MessageEvent</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"message event : "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="n">Throwable</span> <span class="n">throwable</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">throwable</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">});</span>

<span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">notificationChannel</span><span class="o">.</span><span class="na">getSubscribeResult</span><span class="o">();</span>

<span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">component3</span><span class="o">().</span><span class="na">component2</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">result</span><span class="o">.</span><span class="na">component3</span><span class="o">().</span><span class="na">component2</span><span class="o">().</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"subscribed with resource on channelId "</span> <span class="o">+</span>
            <span class="n">notificationChannel</span><span class="o">.</span><span class="na">getChannelId</span><span class="o">()</span> <span class="o">+</span>
            <span class="s">" &amp; appId "</span> <span class="o">+</span> <span class="n">notificationChannel</span><span class="o">.</span><span class="na">getAppId</span><span class="o">());</span>
<span class="o">}</span>
</code></pre>
<p>To listen for notifications use <code>subscribeNotification</code> with a list of <code>Resource</code> including the following : </p>

<ul>
<li><code>Resource.Application</code> to receive application state change (when an application is going background/foreground)</li>
<li><code>Resource.Media</code> to receive TV channel change events</li>
<li><code>Resource.Message</code> to receive messages sent by other BboxAPI STB client</li>
</ul>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>appName</td>
<td>string</td>
<td>a name for your application</td>
</tr>
<tr>
<td>resourceList</td>
<td>List<Resource></td>
<td>list of resources to subscribe</td>
</tr>
<tr>
<td>listener</td>
<td>BboxApiStb.WebSocketListener</td>
<td>websocket event listener</td>
</tr>
</tbody></table>

<p>The underlying flow registers an &quot;application&quot; &amp; subscribes notifications, an appID/channelID is returned from : </p>

<ul>
<li><code>appID</code> is the ID returned by registering an &quot;application&quot; for notifications</li>
<li><code>channelID</code> is the ID retuned by subscribing the previous &quot;application&quot; for specific resources</li>
</ul>

<p>These appID/channelID can be used to send notification, check &quot;Send notification&quot; section</p>

<p>When you are done listening to notification call <code>closeWebsocket</code> to close the websocket. </p>

<aside class="success">
websocket is automatically closed before subscribing, thus no need to call <code>closeWebsocket</code> before <code>subscribeNotification</code>
</aside>
<h2 id='unsubscribe-all-channels'>Unsubscribe all channels</h2>
<p>To unsubscribe all channels ID call <code>unsubscribeAllSync</code>. This will get all distinct opened channels &amp; unsubscribe each of them</p>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">unsubscribeAllSync</span><span class="p">()</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">unsubscribeAllSync</span><span class="o">();</span>
</code></pre><h2 id='send-notification'>Send notification</h2>
<blockquote>
<p>Asynchronous </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">sendNotification</span><span class="p">(</span>
        <span class="n">channelId</span> <span class="p">=</span> <span class="s">"15233003603520.7238189308864336-0.0718767910445014"</span><span class="p">,</span>
        <span class="n">appId</span> <span class="p">=</span> <span class="s">"15233003603520.7238189308864336"</span><span class="p">,</span>
        <span class="n">message</span> <span class="p">=</span> <span class="s">"some message"</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="s">"message sent"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">sendNotification</span><span class="o">(</span>
        <span class="s">"15233003603520.7238189308864336-0.0718767910445014"</span><span class="o">,</span>
        <span class="s">"15233003603520.7238189308864336"</span><span class="o">,</span>
        <span class="s">"some message"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"message sent"</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">fuelError</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">fuelError</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
<span class="o">);</span>
</code></pre>
<blockquote>
<p>Synchronous </p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="kd">val</span> <span class="err">(</span><span class="py">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">=</span> <span class="n">bboxapi</span><span class="p">.</span><span class="n">sendNotificationSync</span><span class="p">(</span>
        <span class="n">channelId</span> <span class="p">=</span> <span class="s">"15233003603520.7238189308864336-0.0718767910445014"</span><span class="p">,</span>
        <span class="n">appId</span> <span class="p">=</span> <span class="s">"15233003603520.7238189308864336"</span><span class="p">,</span>
        <span class="n">message</span> <span class="p">=</span> <span class="s">"some message"</span><span class="p">)</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">().</span><span class="n">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="s">"message sent"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Triple</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">,</span> <span class="n">Response</span><span class="o">,</span> <span class="n">Result</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[],</span> <span class="n">FuelError</span><span class="o">&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">bboxapi</span><span class="o">.</span><span class="na">sendNotificationSync</span><span class="o">(</span>
        <span class="s">"15233003603520.7238189308864336-0.0718767910445014"</span><span class="o">,</span>
        <span class="s">"15233003603520.7238189308864336"</span><span class="o">,</span>
        <span class="s">"some message"</span>
<span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">component3</span><span class="o">().</span><span class="na">component2</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">result</span><span class="o">.</span><span class="na">component3</span><span class="o">().</span><span class="na">component2</span><span class="o">().</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"message sent"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
<p>You can send a notification to a pair channelId / appId.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>channelId</td>
<td>string</td>
<td>ID retuned by subscribing the previous &quot;application&quot; for specific resources</td>
</tr>
<tr>
<td>appId</td>
<td>string</td>
<td>ID returned by registering an &quot;application&quot; for notifications</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>message to send</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<blockquote>
<p>check exception type &amp; response status code on failure :</p>
</blockquote>
<pre class="highlight kotlin tab-kotlin"><code><span class="n">bboxapi</span><span class="p">.</span><span class="n">getApps</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failure</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">ex</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">getException</span><span class="p">()</span>
            <span class="k">when</span> <span class="p">{</span>
                <span class="n">ex</span><span class="p">.</span><span class="n">exception</span> <span class="k">is</span> <span class="n">HttpException</span> <span class="p">-&gt;</span> <span class="n">println</span><span class="p">(</span><span class="s">"http error : ${response.statusCode}"</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">-&gt;</span> <span class="n">ex</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Result</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">data</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="k">get</span><span class="p">()</span>
            <span class="n">println</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">bboxapi</span><span class="o">.</span><span class="na">getApps</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">FuelError</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">error</span><span class="o">.</span><span class="na">getException</span><span class="o">()</span> <span class="k">instanceof</span> <span class="n">HttpException</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"http error : "</span> <span class="o">+</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">error</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Application</span><span class="o">&gt;</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
<p><code>FuelError</code> can be checked for exceptions, for instance : </p>

<table><thead>
<tr>
<th>Exception</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>HttpException</td>
<td>a non 2XX HTTP response was received, check the status code from the response</td>
</tr>
</tbody></table>

<p>Among <code>HttpException</code>, you can find the following :</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- request format is invalid</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- endpoint doesn&#39;t exist (check it starts with http://$IP:$PORT/api.bbox.lan/v0)</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="kotlin">kotlin</a>
                <a href="#" data-language-name="java">java</a>
          </div>
      </div>
    </div>
  </body>
</html>
